<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Neon Apple Predictor — نسخة مصححة</title>
  <link href="https://fonts.googleapis.com/css2?family=Cairo:wght@300;400;600;700&display=swap" rel="stylesheet">
  <style>
    :root{
      --bg:#0b0f17;--line:#1e2a44;--accent:#8df0ff;--text:#e7eef6;
    }
    *{box-sizing:border-box;margin:0;padding:0}
    body{
      background:radial-gradient(1200px 800px at 80% -10%,#122039 0%,#0b0f17 50%,#060a12 100%), var(--bg);
      font-family:"Cairo", system-ui, sans-serif;color:var(--text);overflow-x:hidden;
      -webkit-font-smoothing:antialiased;-moz-osx-font-smoothing:grayscale;
    }
    .wrap{max-width:1200px;margin:0 auto;padding:12px;}
    @keyframes fadeIn{from{opacity:0}to{opacity:1}}
    @keyframes slideDown{from{transform:translateY(-50px);opacity:0}to{transform:translateY(0);opacity:1}}
    @keyframes slideUp{from{transform:translateY(50px);opacity:0}to{transform:translateY(0);opacity:1}}
    @keyframes pop{0%{transform:scale(0.3);opacity:0}70%{transform:scale(1.1);opacity:1}100%{transform:scale(1)}}
    @keyframes blink{0%,50%,100%{opacity:1}25%,75%{opacity:0}}
    /* شاشة البداية */
    #loginScreen{
      display:flex;flex-direction:column;align-items:center;justify-content:center;
      height:100vh;text-align:center;gap:16px;animation:fadeIn 0.6s ease;
    }
    #loginScreen h2{color:var(--accent);margin-bottom:8px;animation:slideDown 0.6s ease}
    #userId{
      padding:10px;font-size:1rem;width:220px;text-align:center;
      border-radius:8px;border:1px solid var(--line);animation:pop 0.6s ease;
      background:rgba(255,255,255,0.02);color:var(--text);
    }
    #status{margin-top:12px;font-weight:bold;min-height:1.2rem}
    .blink{animation:blink 1s infinite}
    .lang-box{display:flex;gap:6px;flex-wrap:wrap;justify-content:center;margin-top:12px;animation:slideUp 0.6s ease}
    .lang-btn{
      border:1px solid #0c2e41;border-radius:8px;padding:6px 10px;background:#12394c;
      color:#fff;cursor:pointer;font-weight:bold;font-size:.85rem;
      transition:transform .15s, background .15s;
    }
    .lang-btn:hover{transform:scale(1.05);background:#1a4d66}
    .link{margin-top:8px;animation:fadeIn 0.8s ease}
    .link a{color:var(--accent);text-decoration:none;word-break:break-all}
    /* HUD واللعبة */
    .hud{
      display:flex;gap:12px;flex-wrap:wrap;align-items:center;justify-content:space-between;
      border:1px solid var(--line);background:#0a1120;padding:10px;border-radius:12px;margin-bottom:12px;
      animation:slideDown 0.6s ease;
    }
    .hud .chip{
      border:1px solid #0c2e41;border-radius:10px;padding:6px 10px;
      background:rgba(14,25,44,.6);color:var(--accent);min-width:140px;
      display:flex;justify-content:space-between;align-items:center;
    }
    .board-wrap{display:flex;flex-direction:row-reverse;align-items:stretch;gap:10px}
    .side{
      display:flex;flex-direction:column-reverse;justify-content:space-between;
      border:1px solid var(--line);border-radius:10px;background:#0b1322;width:90px;padding:6px;
    }
    .multi{
      text-align:center;font-weight:700;color:#c9f7ff;padding:6px 4px;border-radius:6px;border:1px solid #103046;margin:3px 0;font-size:.9rem;
      opacity:0;animation:fadeIn 0.6s forwards;
    }
    .board{
      flex:1;border:1px solid var(--line);border-radius:10px;background:#0b1322;
      display:flex;flex-direction:column;padding:10px;
    }
    .grid{
      display:flex;flex-direction:column-reverse;gap:8px;
    }
    .row{display:grid;grid-template-columns:repeat(5,1fr);gap:8px}
    .cell{
      aspect-ratio:1/1;border-radius:10px;border:1px solid #143a4e;
      background:rgba(20,36,60,.5);cursor:pointer;position:relative;overflow:hidden;
      transition:transform .15s, background .15s;animation:pop 0.45s ease;
      display:flex;align-items:center;justify-content:center;
    }
    .cell:hover{transform:scale(1.03)}
    .cell .icon{position:absolute;inset:0;display:grid;place-items:center;opacity:0;transition:opacity .25s ease-in}
    .cell.revealed .icon{opacity:1}
    .svg{width:60%;height:60%}
    .full .circle{fill:#2c9c42}
    .full .fruit{fill:#ff2a2a}
    .core .circle{fill:#6f2a2a}
    .core .fruit{fill:#ffd9a6}
    .controls{margin-top:10px;display:flex;gap:8px}
    .btn{
      flex:1;text-align:center;background:#0a1d2a;color:#e8fbff;
      padding:10px;border-radius:10px;cursor:pointer;font-weight:bold;
      transition:transform .15s, background .15s;animation:slideUp 0.6s ease;
    }
    .btn:hover{transform:scale(1.03);background:#12394c}
    @media (max-width:600px){
      .hud .chip{min-width:110px}
      .side{width:70px}
    }
  </style>
</head>
<body>
  <!-- شاشة التسجيل -->
  <div id="loginScreen">
    <h2 id="platform">المنصة: Linebet</h2>
    <input type="text" id="userId" maxlength="10" inputmode="numeric" pattern="\d*" placeholder="أدخل المعرف (9-10 أرقام)" aria-label="معرف المستخدم">
    <div id="status" aria-live="polite"></div>
    <div class="lang-box" role="tablist" aria-label="اختيار اللغة">
      <button class="lang-btn" data-lang="ar">عربي</button>
      <button class="lang-btn" data-lang="en">English</button>
      <button class="lang-btn" data-lang="fr">Français</button>
      <button class="lang-btn" data-lang="bn">বাংলা</button>
    </div>
    <div class="link"><a id="loginLink" href="ZERO_bet" target="_blank" rel="noopener noreferrer"></a></div>
    <img src="" alt="">
  </div>

  <!-- شاشة اللعبة -->
  <div id="gameScreen" style="display:none">
    <div class="wrap">
      <div class="hud">
        <div class="chip"><span id="label-online">متصلون</span><b id="online">26</b></div>
        <div class="chip"><span id="label-id">المعرّف</span><b id="pid">0</b></div>
        <div class="lang-box">
          <button class="lang-btn" data-lang="ar">عربي</button>
          <button class="lang-btn" data-lang="en">English</button>
          <button class="lang-btn" data-lang="fr">Français</button>
          <button class="lang-btn" data-lang="bn">বাংলা</button>
        </div>
      </div>
      <div class="board-wrap">
        <aside class="side" id="multis" aria-hidden="false"></aside>
        <section class="board" aria-label="لوحة اللعبة">
          <div class="grid" id="grid"></div>
          <div class="controls">
            <button class="btn" id="reveal">إظهار الكل</button>
            <button class="btn" id="new">لعبة جديدة</button>
          </div>
        </section>
      </div>
    </div>
  </div>

  <script>
    document.addEventListener('DOMContentLoaded', () => {
      // عناصر DOM
      const gridEl = document.getElementById('grid');
      const multisEl = document.getElementById('multis');
      const btnReveal = document.getElementById('reveal');
      const btnNew = document.getElementById('new');
      const userIdInput = document.getElementById('userId');
      const statusEl = document.getElementById('status');
      const loginScreen = document.getElementById('loginScreen');
      const gameScreen = document.getElementById('gameScreen');
      const pidEl = document.getElementById('pid');
      const onlineEl = document.getElementById('online');
      const loginLink = document.getElementById('loginLink');

      const rnd = n => Math.floor(Math.random() * n);
      const odds = ["x1.23","x1.54","x1.93","x2.41","x4.02","x6.71","x11.18","x27.92","x69.93","x349.68"];
      const GRID_ROWS = 10;

      const svgFull = `<svg viewBox="0 0 100 100" class="svg" aria-hidden="true"><circle class="circle" cx="50" cy="50" r="48"/><path class="fruit" d="M54,30c14,0,24,8,24,22c0,18-16,28-28,28S26,72,26,54c0-14,10-22,24-22"/></svg>`;
      const svgCore = `<svg viewBox="0 0 100 100" class="svg" aria-hidden="true"><circle class="circle" cx="50" cy="50" r="48"/><path class="fruit" d="M40,25c5,6,7,13,7,22c0,9-2,16-7,22c4,4,10,7,18,7s14-3,18-7c-5-6-7-13-7-22c0-9,2-16,7-22z"/></svg>`;

      // ترجمات ونصوص
      const translations = {
        ar: { platform: "المنصة: Linebet", placeholder: "أدخل المعرف (9-10 أرقام)", online: "متصلون", id: "المعرّف", reveal: "إظهار الكل", new: "لعبة جديدة", linkText: "https://t.me/nerovipbet", linkHref: "https://t.me/nerovipbet" },
        en: { platform: "Platform: Linebet", placeholder: "Enter ID (9-10 digits)", online: "Online", id: "ID", reveal: "Reveal All", new: "New Game", linkText: "Telegram Channel", linkHref: "https://t.me/nerovipbet" },
        fr: { platform: "Plateforme: Linebet", placeholder: "Entrez l'ID (9-10 chiffres)", online: "En ligne", id: "ID", reveal: "Tout Révéler", new: "Nouveau Jeu", linkText: "Chaîne Telegram", linkHref: "https://t.me/nerovipbet" },
        bn: { platform: "প্ল্যাটফর্ম: Linebet", placeholder: "আইডি দিন (৯-১০ সংখ্যা)", online: "অনলাইন", id: "আইডি", reveal: "সব দেখাও", new: "নতুন খেলা", linkText: "টেলিগ্রাম চ্যানেল", linkHref: "https://t.me/nerovipbet" }
      };

      function setLang(lang) {
        const t = translations[lang] || translations.ar;
        document.getElementById("platform").textContent = t.platform;
        userIdInput.placeholder = t.placeholder;
        document.getElementById("label-online").textContent = t.online;
        document.getElementById("label-id").textContent = t.id;
        btnReveal.textContent = t.reveal;
        btnNew.textContent = t.new;
        // نص ولينك الاتصال
        loginLink.textContent = t.linkText;
        loginLink.href = t.linkHref;
      }

      // ربط أزرار اختيار اللغة
      document.querySelectorAll('.lang-btn').forEach(btn => {
        btn.addEventListener('click', () => setLang(btn.dataset.lang));
      });

      // بناء قائمة المضاعفات
      function buildMultipliers() {
        multisEl.innerHTML = '';
        odds.forEach((val, i) => {
          const div = document.createElement('div');
          div.className = 'multi';
          div.style.animationDelay = `${i * 0.12}s`;
          div.textContent = val;
          multisEl.appendChild(div);
        });
      }

      function getRowPattern(row) {
        if (row >= 1 && row <= 4) return { core: 1, full: 4 };
        if (row >= 5 && row <= 7) return { core: 2, full: 3 };
        if (row >= 8 && row <= 9) return { core: 3, full: 2 };
        if (row === 10) return { core: 4, full: 1 };
        return { core: 0, full: 5 };
      }

      function generateBoard() {
        gridEl.innerHTML = '';
        buildMultipliers();
        for (let row = 1; row <= GRID_ROWS; row++) {
          const { core, full } = getRowPattern(row);
          const pool = Array(core).fill('core').concat(Array(full).fill('full'));
          // خلط Fisher–Yates
          for (let i = pool.length - 1; i > 0; i--) {
            const j = rnd(i + 1);
            [pool[i], pool[j]] = [pool[j], pool[i]];
          }
          const rowEl = document.createElement('div');
          rowEl.className = 'row';
          pool.forEach((type, i) => {
            const cell = document.createElement('button');
            cell.type = 'button';
            cell.className = 'cell';
            cell.style.animationDelay = `${i * 0.06}s`;
            // اضافة المحتوى
            cell.innerHTML = `<div class="icon ${type}">${type === 'full' ? svgFull : svgCore}</div>`;
            // عند الضغط يُظهِر الخلية
            cell.addEventListener('click', () => cell.classList.add('revealed'));
            rowEl.appendChild(cell);
          });
          gridEl.appendChild(rowEl);
        }
      }

      // أزرار التحكم
      btnReveal.addEventListener('click', () => {
        // توليد جديد ثم إظهار الكل
        generateBoard();
        gridEl.querySelectorAll('.cell').forEach(c => c.classList.add('revealed'));
      });
      btnNew.addEventListener('click', () => generateBoard());

      // تحديث HUD
      function updateHUD() {
        onlineEl.textContent = 20 + rnd(40);
      }
      setInterval(updateHUD, 3000);

      // حماية من الضغط المتكرر
      let isLoggingIn = false;

      userIdInput.addEventListener('input', () => {
        const v = userIdInput.value.trim();
        const valid = /^[0-9]{9,10}$/.test(v);
        if (valid && !isLoggingIn) {
          // منع اعاده المحاولة
          isLoggingIn = true;
          userIdInput.disabled = true;
          statusEl.textContent = "جارٍ ربط بالبروموكود TE100...";
          statusEl.classList.add("blink");
          // تأخير قصير لتحسين تجربة المستخدم
          setTimeout(() => {
            loginScreen.style.display = 'none';
            gameScreen.style.display = 'block';
            pidEl.textContent = v;
            updateHUD();
            generateBoard();
            // ازالة الحالة عند الدخول
            statusEl.classList.remove("blink");
          }, 1000);
        } else if (!valid) {
          statusEl.textContent = "";
          statusEl.classList.remove("blink");
          userIdInput.disabled = false;
          isLoggingIn = false;
        }
      });

      // إعداد افتراضي
      setLang('ar');
      userIdInput.focus();
    });
  </script>
</body>
</html>
